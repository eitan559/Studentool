<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <title>Studentool â€“ Recorder</title>
</head>
<body>

<h2>ğŸ™ï¸ ×”×§×œ×˜×”</h2>
<button id="start">×”×ª×—×œ</button>
<button id="stop" disabled>×¢×¦×•×¨</button>

<script>
let recorder;
let chunks = [];

document.getElementById("start").onclick = async () => {
  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
  recorder = new MediaRecorder(stream);
  chunks = [];

  recorder.ondataavailable = e => chunks.push(e.data);
  recorder.start();

  document.getElementById("start").disabled = true;
  document.getElementById("stop").disabled = false;
};

document.getElementById("stop").onclick = () => {
  recorder.stop();

  recorder.onstop = () => {
    const blob = new Blob(chunks, { type: "audio/webm" });
    const reader = new FileReader();

    reader.onloadend = () => {
      localStorage.setItem("studentoolAudio", reader.result);
      window.location.href = "player.html";
    };

    reader.readAsDataURL(blob);
  };

  document.getElementById("start").disabled = false;
  document.getElementById("stop").disabled = true;
};
</script>

</body>
</html>
